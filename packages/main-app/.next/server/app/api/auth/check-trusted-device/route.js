"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/check-trusted-device/route";
exports.ids = ["app/api/auth/check-trusted-device/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&page=%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute.ts&appDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&page=%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute.ts&appDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/../../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_openi_OneDrive_BellRegistry_packages_main_app_src_app_api_auth_check_trusted_device_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/check-trusted-device/route.ts */ \"(rsc)/./src/app/api/auth/check-trusted-device/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/check-trusted-device/route\",\n        pathname: \"/api/auth/check-trusted-device\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/check-trusted-device/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\openi\\\\OneDrive\\\\BellRegistry\\\\packages\\\\main-app\\\\src\\\\app\\\\api\\\\auth\\\\check-trusted-device\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_openi_OneDrive_BellRegistry_packages_main_app_src_app_api_auth_check_trusted_device_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/check-trusted-device/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGYXV0aCUyRmNoZWNrLXRydXN0ZWQtZGV2aWNlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhdXRoJTJGY2hlY2stdHJ1c3RlZC1kZXZpY2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhdXRoJTJGY2hlY2stdHJ1c3RlZC1kZXZpY2UlMkZyb3V0ZS50cyZhcHBEaXI9QyUzQSU1Q1VzZXJzJTVDb3BlbmklNUNPbmVEcml2ZSU1Q0JlbGxSZWdpc3RyeSU1Q3BhY2thZ2VzJTVDbWFpbi1hcHAlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q29wZW5pJTVDT25lRHJpdmUlNUNCZWxsUmVnaXN0cnklNUNwYWNrYWdlcyU1Q21haW4tYXBwJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNpRTtBQUM5STtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL0BiZWxsLXJlZ2lzdHJ5L21haW4tYXBwLz8xMzU5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXG9wZW5pXFxcXE9uZURyaXZlXFxcXEJlbGxSZWdpc3RyeVxcXFxwYWNrYWdlc1xcXFxtYWluLWFwcFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXGNoZWNrLXRydXN0ZWQtZGV2aWNlXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9jaGVjay10cnVzdGVkLWRldmljZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvY2hlY2stdHJ1c3RlZC1kZXZpY2VcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvY2hlY2stdHJ1c3RlZC1kZXZpY2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxvcGVuaVxcXFxPbmVEcml2ZVxcXFxCZWxsUmVnaXN0cnlcXFxccGFja2FnZXNcXFxcbWFpbi1hcHBcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxjaGVjay10cnVzdGVkLWRldmljZVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL2NoZWNrLXRydXN0ZWQtZGV2aWNlL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&page=%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute.ts&appDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/auth/check-trusted-device/route.ts":
/*!********************************************************!*\
  !*** ./src/app/api/auth/check-trusted-device/route.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/../../node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_trusted_device_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/trusted-device-service */ \"(rsc)/./src/lib/trusted-device-service.ts\");\n\n\n\nasync function POST(request) {\n    try {\n        const { email } = await request.json();\n        if (!email) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Email is required\"\n            }, {\n                status: 400\n            });\n        }\n        const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findUnique({\n            where: {\n                email\n            },\n            select: {\n                id: true,\n                twoFactorEnabled: true,\n                isDeleted: true\n            }\n        });\n        if (!user || user.isDeleted) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"User not found\"\n            }, {\n                status: 404\n            });\n        }\n        // If 2FA is not enabled, device trust is not relevant\n        if (!user.twoFactorEnabled) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                isTrusted: false,\n                requires2FA: false\n            });\n        }\n        // Check for device token in cookies\n        const deviceToken = request.cookies.get(\"device_token\")?.value;\n        if (!deviceToken) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                isTrusted: false,\n                requires2FA: true\n            });\n        }\n        // Verify the device token\n        const verification = await (0,_lib_trusted_device_service__WEBPACK_IMPORTED_MODULE_2__.verifyTrustedDevice)(user.id, deviceToken);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            isTrusted: verification.isValid,\n            requires2FA: !verification.isValid\n        });\n    } catch (error) {\n        console.error(\"Error checking trusted device:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL2NoZWNrLXRydXN0ZWQtZGV2aWNlL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBd0Q7QUFDbEI7QUFDNkI7QUFFNUQsZUFBZUcsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGLE1BQU0sRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUQsUUFBUUUsSUFBSTtRQUVwQyxJQUFJLENBQUNELE9BQU87WUFDVixPQUFPTCxrRkFBWUEsQ0FBQ00sSUFBSSxDQUFDO2dCQUN2QkMsT0FBTztZQUNULEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNuQjtRQUVBLE1BQU1DLE9BQU8sTUFBTVIsK0NBQU1BLENBQUNRLElBQUksQ0FBQ0MsVUFBVSxDQUFDO1lBQ3hDQyxPQUFPO2dCQUFFTjtZQUFNO1lBQ2ZPLFFBQVE7Z0JBQ05DLElBQUk7Z0JBQ0pDLGtCQUFrQjtnQkFDbEJDLFdBQVc7WUFDYjtRQUNGO1FBRUEsSUFBSSxDQUFDTixRQUFRQSxLQUFLTSxTQUFTLEVBQUU7WUFDM0IsT0FBT2Ysa0ZBQVlBLENBQUNNLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFpQixHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDdEU7UUFFQSxzREFBc0Q7UUFDdEQsSUFBSSxDQUFDQyxLQUFLSyxnQkFBZ0IsRUFBRTtZQUMxQixPQUFPZCxrRkFBWUEsQ0FBQ00sSUFBSSxDQUFDO2dCQUN2QlUsV0FBVztnQkFDWEMsYUFBYTtZQUNmO1FBQ0Y7UUFFQSxvQ0FBb0M7UUFDcEMsTUFBTUMsY0FBY2QsUUFBUWUsT0FBTyxDQUFDQyxHQUFHLENBQUMsaUJBQWlCQztRQUV6RCxJQUFJLENBQUNILGFBQWE7WUFDaEIsT0FBT2xCLGtGQUFZQSxDQUFDTSxJQUFJLENBQUM7Z0JBQ3ZCVSxXQUFXO2dCQUNYQyxhQUFhO1lBQ2Y7UUFDRjtRQUVBLDBCQUEwQjtRQUMxQixNQUFNSyxlQUFlLE1BQU1wQixnRkFBbUJBLENBQUNPLEtBQUtJLEVBQUUsRUFBRUs7UUFFeEQsT0FBT2xCLGtGQUFZQSxDQUFDTSxJQUFJLENBQUM7WUFDdkJVLFdBQVdNLGFBQWFDLE9BQU87WUFDL0JOLGFBQWEsQ0FBQ0ssYUFBYUMsT0FBTztRQUNwQztJQUNGLEVBQUUsT0FBT2hCLE9BQU87UUFDZGlCLFFBQVFqQixLQUFLLENBQUMsa0NBQWtDQTtRQUNoRCxPQUFPUCxrRkFBWUEsQ0FBQ00sSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBd0IsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDN0U7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL0BiZWxsLXJlZ2lzdHJ5L21haW4tYXBwLy4vc3JjL2FwcC9hcGkvYXV0aC9jaGVjay10cnVzdGVkLWRldmljZS9yb3V0ZS50cz83NjUzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gJ0AvbGliL3ByaXNtYSc7XHJcbmltcG9ydCB7IHZlcmlmeVRydXN0ZWREZXZpY2UgfSBmcm9tICdAL2xpYi90cnVzdGVkLWRldmljZS1zZXJ2aWNlJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHsgZW1haWwgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG5cclxuICAgIGlmICghZW1haWwpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXHJcbiAgICAgICAgZXJyb3I6ICdFbWFpbCBpcyByZXF1aXJlZCcgXHJcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xyXG4gICAgICB3aGVyZTogeyBlbWFpbCB9LFxyXG4gICAgICBzZWxlY3Q6IHtcclxuICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICB0d29GYWN0b3JFbmFibGVkOiB0cnVlLFxyXG4gICAgICAgIGlzRGVsZXRlZDogdHJ1ZVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIXVzZXIgfHwgdXNlci5pc0RlbGV0ZWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVc2VyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IDQwNCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJZiAyRkEgaXMgbm90IGVuYWJsZWQsIGRldmljZSB0cnVzdCBpcyBub3QgcmVsZXZhbnRcclxuICAgIGlmICghdXNlci50d29GYWN0b3JFbmFibGVkKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICAgIGlzVHJ1c3RlZDogZmFsc2UsXHJcbiAgICAgICAgcmVxdWlyZXMyRkE6IGZhbHNlIFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBmb3IgZGV2aWNlIHRva2VuIGluIGNvb2tpZXNcclxuICAgIGNvbnN0IGRldmljZVRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldCgnZGV2aWNlX3Rva2VuJyk/LnZhbHVlO1xyXG4gICAgXHJcbiAgICBpZiAoIWRldmljZVRva2VuKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICAgIGlzVHJ1c3RlZDogZmFsc2UsXHJcbiAgICAgICAgcmVxdWlyZXMyRkE6IHRydWUgXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFZlcmlmeSB0aGUgZGV2aWNlIHRva2VuXHJcbiAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCB2ZXJpZnlUcnVzdGVkRGV2aWNlKHVzZXIuaWQsIGRldmljZVRva2VuKTtcclxuICAgIFxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXHJcbiAgICAgIGlzVHJ1c3RlZDogdmVyaWZpY2F0aW9uLmlzVmFsaWQsXHJcbiAgICAgIHJlcXVpcmVzMkZBOiAhdmVyaWZpY2F0aW9uLmlzVmFsaWQgXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcgdHJ1c3RlZCBkZXZpY2U6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sIHsgc3RhdHVzOiA1MDAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwcmlzbWEiLCJ2ZXJpZnlUcnVzdGVkRGV2aWNlIiwiUE9TVCIsInJlcXVlc3QiLCJlbWFpbCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJzZWxlY3QiLCJpZCIsInR3b0ZhY3RvckVuYWJsZWQiLCJpc0RlbGV0ZWQiLCJpc1RydXN0ZWQiLCJyZXF1aXJlczJGQSIsImRldmljZVRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwidmVyaWZpY2F0aW9uIiwiaXNWYWxpZCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/check-trusted-device/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prismaClientSingleton = ()=>{\n    return new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n};\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? prismaClientSingleton();\nif (true) {\n    globalForPrisma.prisma = prisma;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEM7QUFFOUMsTUFBTUMsd0JBQXdCO0lBQzVCLE9BQU8sSUFBSUQsd0RBQVlBO0FBQ3pCO0FBSUEsTUFBTUUsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSUgsd0JBQXdCO0FBRXhFLElBQUlJLElBQXFDLEVBQUU7SUFDekNILGdCQUFnQkUsTUFBTSxHQUFHQTtBQUMzQiIsInNvdXJjZXMiOlsid2VicGFjazovL0BiZWxsLXJlZ2lzdHJ5L21haW4tYXBwLy4vc3JjL2xpYi9wcmlzbWEudHM/MDFkNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcclxuXHJcbmNvbnN0IHByaXNtYUNsaWVudFNpbmdsZXRvbiA9ICgpID0+IHtcclxuICByZXR1cm4gbmV3IFByaXNtYUNsaWVudCgpO1xyXG59O1xyXG5cclxudHlwZSBQcmlzbWFDbGllbnRTaW5nbGV0b24gPSBSZXR1cm5UeXBlPHR5cGVvZiBwcmlzbWFDbGllbnRTaW5nbGV0b24+O1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcclxuICBwcmlzbWE6IFByaXNtYUNsaWVudFNpbmdsZXRvbiB8IHVuZGVmaW5lZDtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID8/IHByaXNtYUNsaWVudFNpbmdsZXRvbigpO1xyXG5cclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xyXG4gIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7XHJcbn0gIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsInByaXNtYUNsaWVudFNpbmdsZXRvbiIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJwcmlzbWEiLCJwcm9jZXNzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/trusted-device-service.ts":
/*!*******************************************!*\
  !*** ./src/lib/trusted-device-service.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cleanupExpiredDevices: () => (/* binding */ cleanupExpiredDevices),\n/* harmony export */   createTrustedDevice: () => (/* binding */ createTrustedDevice),\n/* harmony export */   extractDeviceName: () => (/* binding */ extractDeviceName),\n/* harmony export */   generateDeviceToken: () => (/* binding */ generateDeviceToken),\n/* harmony export */   getApproximateLocation: () => (/* binding */ getApproximateLocation),\n/* harmony export */   getUserTrustedDevices: () => (/* binding */ getUserTrustedDevices),\n/* harmony export */   hashDeviceToken: () => (/* binding */ hashDeviceToken),\n/* harmony export */   maskIpAddress: () => (/* binding */ maskIpAddress),\n/* harmony export */   removeAllTrustedDevices: () => (/* binding */ removeAllTrustedDevices),\n/* harmony export */   removeTrustedDevice: () => (/* binding */ removeTrustedDevice),\n/* harmony export */   updateDeviceLastUsed: () => (/* binding */ updateDeviceLastUsed),\n/* harmony export */   verifyDeviceToken: () => (/* binding */ verifyDeviceToken),\n/* harmony export */   verifyTrustedDevice: () => (/* binding */ verifyTrustedDevice)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/../../node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n// Generate a cryptographically secure token\nfunction generateDeviceToken() {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().randomBytes(32).toString(\"hex\");\n}\n// Hash the device token for database storage\nasync function hashDeviceToken(token) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().hash(token, 12);\n}\n// Verify a device token against the hashed version\nasync function verifyDeviceToken(token, hashedToken) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().compare(token, hashedToken);\n}\n// Extract device name from user agent\nfunction extractDeviceName(userAgent) {\n    const ua = userAgent.toLowerCase();\n    // Browser detection\n    let browser = \"Unknown Browser\";\n    if (ua.includes(\"chrome\")) browser = \"Chrome\";\n    else if (ua.includes(\"firefox\")) browser = \"Firefox\";\n    else if (ua.includes(\"safari\")) browser = \"Safari\";\n    else if (ua.includes(\"edge\")) browser = \"Edge\";\n    else if (ua.includes(\"opera\")) browser = \"Opera\";\n    // OS detection\n    let os = \"Unknown OS\";\n    if (ua.includes(\"windows\")) os = \"Windows\";\n    else if (ua.includes(\"macintosh\") || ua.includes(\"mac os\")) os = \"macOS\";\n    else if (ua.includes(\"linux\")) os = \"Linux\";\n    else if (ua.includes(\"android\")) os = \"Android\";\n    else if (ua.includes(\"iphone\") || ua.includes(\"ipad\")) os = \"iOS\";\n    return `${browser} on ${os}`;\n}\n// Create a new trusted device\nasync function createTrustedDevice(userId, deviceInfo) {\n    const token = generateDeviceToken();\n    const hashedToken = await hashDeviceToken(token);\n    const deviceName = extractDeviceName(deviceInfo.userAgent);\n    // Set expiration to 30 days from now\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 30);\n    const trustedDevice = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.create({\n        data: {\n            userId,\n            deviceToken: hashedToken,\n            deviceName,\n            userAgent: deviceInfo.userAgent,\n            ipAddress: deviceInfo.ipAddress,\n            expiresAt\n        }\n    });\n    return {\n        token,\n        deviceId: trustedDevice.id\n    };\n}\n// Verify if a device is trusted and not expired\nasync function verifyTrustedDevice(userId, token) {\n    if (!token) {\n        return {\n            isValid: false\n        };\n    }\n    // Get all trusted devices for the user\n    const trustedDevices = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.findMany({\n        where: {\n            userId,\n            expiresAt: {\n                gt: new Date()\n            }\n        }\n    });\n    // Check each device token\n    for (const device of trustedDevices){\n        const isValid = await verifyDeviceToken(token, device.deviceToken);\n        if (isValid) {\n            // Update last used timestamp (sliding expiration)\n            await updateDeviceLastUsed(device.id);\n            return {\n                isValid: true,\n                deviceId: device.id\n            };\n        }\n    }\n    return {\n        isValid: false\n    };\n}\n// Update device last used timestamp and extend expiration (sliding expiration)\nasync function updateDeviceLastUsed(deviceId) {\n    const newExpiresAt = new Date();\n    newExpiresAt.setDate(newExpiresAt.getDate() + 30);\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.update({\n        where: {\n            id: deviceId\n        },\n        data: {\n            lastUsedAt: new Date(),\n            expiresAt: newExpiresAt\n        }\n    });\n}\n// Get all trusted devices for a user\nasync function getUserTrustedDevices(userId) {\n    const devices = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.findMany({\n        where: {\n            userId,\n            expiresAt: {\n                gt: new Date()\n            }\n        },\n        orderBy: {\n            lastUsedAt: \"desc\"\n        },\n        select: {\n            id: true,\n            deviceName: true,\n            userAgent: true,\n            ipAddress: true,\n            createdAt: true,\n            lastUsedAt: true,\n            expiresAt: true\n        }\n    });\n    return devices;\n}\n// Remove a specific trusted device\nasync function removeTrustedDevice(userId, deviceId) {\n    try {\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.delete({\n            where: {\n                id: deviceId,\n                userId\n            }\n        });\n        return true;\n    } catch (error) {\n        console.error(\"Error removing trusted device:\", error);\n        return false;\n    }\n}\n// Remove all trusted devices for a user\nasync function removeAllTrustedDevices(userId) {\n    const result = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.deleteMany({\n        where: {\n            userId\n        }\n    });\n    return result.count;\n}\n// Clean up expired trusted devices (for cron job)\nasync function cleanupExpiredDevices() {\n    const result = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.trustedDevice.deleteMany({\n        where: {\n            expiresAt: {\n                lt: new Date()\n            }\n        }\n    });\n    return result.count;\n}\n// Get approximate location from IP (you might want to integrate with a geo service)\nfunction getApproximateLocation(ipAddress) {\n    // This is a placeholder - in production you'd use a service like MaxMind or ipapi\n    if (ipAddress === \"127.0.0.1\" || ipAddress.startsWith(\"192.168.\") || ipAddress.startsWith(\"10.\")) {\n        return \"Local Network\";\n    }\n    return \"Unknown Location\";\n}\n// Mask IP address for privacy\nfunction maskIpAddress(ipAddress) {\n    const parts = ipAddress.split(\".\");\n    if (parts.length === 4) {\n        return `${parts[0]}.${parts[1]}.*.***`;\n    }\n    return ipAddress.slice(0, 8) + \"***\"; // For IPv6 or other formats\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3RydXN0ZWQtZGV2aWNlLXNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNDO0FBQ1Y7QUFDRTtBQWlCOUIsNENBQTRDO0FBQ3JDLFNBQVNHO0lBQ2QsT0FBT0YseURBQWtCLENBQUMsSUFBSUksUUFBUSxDQUFDO0FBQ3pDO0FBRUEsNkNBQTZDO0FBQ3RDLGVBQWVDLGdCQUFnQkMsS0FBYTtJQUNqRCxPQUFPTCxvREFBVyxDQUFDSyxPQUFPO0FBQzVCO0FBRUEsbURBQW1EO0FBQzVDLGVBQWVFLGtCQUFrQkYsS0FBYSxFQUFFRyxXQUFtQjtJQUN4RSxPQUFPUix1REFBYyxDQUFDSyxPQUFPRztBQUMvQjtBQUVBLHNDQUFzQztBQUMvQixTQUFTRSxrQkFBa0JDLFNBQWlCO0lBQ2pELE1BQU1DLEtBQUtELFVBQVVFLFdBQVc7SUFFaEMsb0JBQW9CO0lBQ3BCLElBQUlDLFVBQVU7SUFDZCxJQUFJRixHQUFHRyxRQUFRLENBQUMsV0FBV0QsVUFBVTtTQUNoQyxJQUFJRixHQUFHRyxRQUFRLENBQUMsWUFBWUQsVUFBVTtTQUN0QyxJQUFJRixHQUFHRyxRQUFRLENBQUMsV0FBV0QsVUFBVTtTQUNyQyxJQUFJRixHQUFHRyxRQUFRLENBQUMsU0FBU0QsVUFBVTtTQUNuQyxJQUFJRixHQUFHRyxRQUFRLENBQUMsVUFBVUQsVUFBVTtJQUV6QyxlQUFlO0lBQ2YsSUFBSUUsS0FBSztJQUNULElBQUlKLEdBQUdHLFFBQVEsQ0FBQyxZQUFZQyxLQUFLO1NBQzVCLElBQUlKLEdBQUdHLFFBQVEsQ0FBQyxnQkFBZ0JILEdBQUdHLFFBQVEsQ0FBQyxXQUFXQyxLQUFLO1NBQzVELElBQUlKLEdBQUdHLFFBQVEsQ0FBQyxVQUFVQyxLQUFLO1NBQy9CLElBQUlKLEdBQUdHLFFBQVEsQ0FBQyxZQUFZQyxLQUFLO1NBQ2pDLElBQUlKLEdBQUdHLFFBQVEsQ0FBQyxhQUFhSCxHQUFHRyxRQUFRLENBQUMsU0FBU0MsS0FBSztJ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TUFBTXZELCtDQUFNQSxDQUFDMkIsYUFBYSxDQUFDNkIsVUFBVSxDQUFDO1FBQ25EbEIsT0FBTztZQUFFbEI7UUFBTztJQUNsQjtJQUVBLE9BQU9tQyxPQUFPRSxLQUFLO0FBQ3JCO0FBRUEsa0RBQWtEO0FBQzNDLGVBQWVDO0lBQ3BCLE1BQU1ILFNBQVMsTUFBTXZELCtDQUFNQSxDQUFDMkIsYUFBYSxDQUFDNkIsVUFBVSxDQUFDO1FBQ25EbEIsT0FBTztZQUNMZixXQUFXO2dCQUNUb0MsSUFBSSxJQUFJbkM7WUFDVjtRQUNGO0lBQ0Y7SUFFQSxPQUFPK0IsT0FBT0UsS0FBSztBQUNyQjtBQUVBLG9GQUFvRjtBQUM3RSxTQUFTRyx1QkFBdUI3QixTQUFpQjtJQUN0RCxrRkFBa0Y7SUFDbEYsSUFBSUEsY0FBYyxlQUFlQSxVQUFVOEIsVUFBVSxDQUFDLGVBQWU5QixVQUFVOEIsVUFBVSxDQUFDLFFBQVE7UUFDaEcsT0FBTztJQUNUO0lBQ0EsT0FBTztBQUNUO0FBRUEsOEJBQThCO0FBQ3ZCLFNBQVNDLGNBQWMvQixTQUFpQjtJQUM3QyxNQUFNZ0MsUUFBUWhDLFVBQVVpQyxLQUFLLENBQUM7SUFDOUIsSUFBSUQsTUFBTUUsTUFBTSxLQUFLLEdBQUc7UUFDdEIsT0FBTyxDQUFDLEVBQUVGLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFQSxLQUFLLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQztJQUN4QztJQUNBLE9BQU9oQyxVQUFVbUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxPQUFPLDRCQUE0QjtBQUNwRSIsInNvdXJjZXMiOlsid2VicGFjazovL0BiZWxsLXJlZ2lzdHJ5L21haW4tYXBwLy4vc3JjL2xpYi90cnVzdGVkLWRldmljZS1zZXJ2aWNlLnRzPzcyMGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xyXG5pbXBvcnQgY3J5cHRvIGZyb20gXCJjcnlwdG9cIjtcclxuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRGV2aWNlSW5mbyB7XHJcbiAgdXNlckFnZW50OiBzdHJpbmc7XHJcbiAgaXBBZGRyZXNzOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVHJ1c3RlZERldmljZURhdGEge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgZGV2aWNlTmFtZTogc3RyaW5nIHwgbnVsbDtcclxuICB1c2VyQWdlbnQ6IHN0cmluZztcclxuICBpcEFkZHJlc3M6IHN0cmluZztcclxuICBjcmVhdGVkQXQ6IERhdGU7XHJcbiAgbGFzdFVzZWRBdDogRGF0ZTtcclxuICBleHBpcmVzQXQ6IERhdGU7XHJcbn1cclxuXHJcbi8vIEdlbmVyYXRlIGEgY3J5cHRvZ3JhcGhpY2FsbHkgc2VjdXJlIHRva2VuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZURldmljZVRva2VuKCk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGNyeXB0by5yYW5kb21CeXRlcygzMikudG9TdHJpbmcoJ2hleCcpO1xyXG59XHJcblxyXG4vLyBIYXNoIHRoZSBkZXZpY2UgdG9rZW4gZm9yIGRhdGFiYXNlIHN0b3JhZ2VcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc2hEZXZpY2VUb2tlbih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICByZXR1cm4gYmNyeXB0Lmhhc2godG9rZW4sIDEyKTtcclxufVxyXG5cclxuLy8gVmVyaWZ5IGEgZGV2aWNlIHRva2VuIGFnYWluc3QgdGhlIGhhc2hlZCB2ZXJzaW9uXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlEZXZpY2VUb2tlbih0b2tlbjogc3RyaW5nLCBoYXNoZWRUb2tlbjogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHRva2VuLCBoYXNoZWRUb2tlbik7XHJcbn1cclxuXHJcbi8vIEV4dHJhY3QgZGV2aWNlIG5hbWUgZnJvbSB1c2VyIGFnZW50XHJcbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0RGV2aWNlTmFtZSh1c2VyQWdlbnQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgdWEgPSB1c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcclxuICBcclxuICAvLyBCcm93c2VyIGRldGVjdGlvblxyXG4gIGxldCBicm93c2VyID0gJ1Vua25vd24gQnJvd3Nlcic7XHJcbiAgaWYgKHVhLmluY2x1ZGVzKCdjaHJvbWUnKSkgYnJvd3NlciA9ICdDaHJvbWUnO1xyXG4gIGVsc2UgaWYgKHVhLmluY2x1ZGVzKCdmaXJlZm94JykpIGJyb3dzZXIgPSAnRmlyZWZveCc7XHJcbiAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ3NhZmFyaScpKSBicm93c2VyID0gJ1NhZmFyaSc7XHJcbiAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ2VkZ2UnKSkgYnJvd3NlciA9ICdFZGdlJztcclxuICBlbHNlIGlmICh1YS5pbmNsdWRlcygnb3BlcmEnKSkgYnJvd3NlciA9ICdPcGVyYSc7XHJcbiAgXHJcbiAgLy8gT1MgZGV0ZWN0aW9uXHJcbiAgbGV0IG9zID0gJ1Vua25vd24gT1MnO1xyXG4gIGlmICh1YS5pbmNsdWRlcygnd2luZG93cycpKSBvcyA9ICdXaW5kb3dzJztcclxuICBlbHNlIGlmICh1YS5pbmNsdWRlcygnbWFjaW50b3NoJykgfHwgdWEuaW5jbHVkZXMoJ21hYyBvcycpKSBvcyA9ICdtYWNPUyc7XHJcbiAgZWxzZSBpZiAodWEuaW5jbHVkZXMoJ2xpbnV4JykpIG9zID0gJ0xpbnV4JztcclxuICBlbHNlIGlmICh1YS5pbmNsdWRlcygnYW5kcm9pZCcpKSBvcyA9ICdBbmRyb2lkJztcclxuICBlbHNlIGlmICh1YS5pbmNsdWRlcygnaXBob25lJykgfHwgdWEuaW5jbHVkZXMoJ2lwYWQnKSkgb3MgPSAnaU9TJztcclxuICBcclxuICByZXR1cm4gYCR7YnJvd3Nlcn0gb24gJHtvc31gO1xyXG59XHJcblxyXG4vLyBDcmVhdGUgYSBuZXcgdHJ1c3RlZCBkZXZpY2VcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRydXN0ZWREZXZpY2UoXHJcbiAgdXNlcklkOiBzdHJpbmcsXHJcbiAgZGV2aWNlSW5mbzogRGV2aWNlSW5mb1xyXG4pOiBQcm9taXNlPHsgdG9rZW46IHN0cmluZzsgZGV2aWNlSWQ6IHN0cmluZyB9PiB7XHJcbiAgY29uc3QgdG9rZW4gPSBnZW5lcmF0ZURldmljZVRva2VuKCk7XHJcbiAgY29uc3QgaGFzaGVkVG9rZW4gPSBhd2FpdCBoYXNoRGV2aWNlVG9rZW4odG9rZW4pO1xyXG4gIGNvbnN0IGRldmljZU5hbWUgPSBleHRyYWN0RGV2aWNlTmFtZShkZXZpY2VJbmZvLnVzZXJBZ2VudCk7XHJcbiAgXHJcbiAgLy8gU2V0IGV4cGlyYXRpb24gdG8gMzAgZGF5cyBmcm9tIG5vd1xyXG4gIGNvbnN0IGV4cGlyZXNBdCA9IG5ldyBEYXRlKCk7XHJcbiAgZXhwaXJlc0F0LnNldERhdGUoZXhwaXJlc0F0LmdldERhdGUoKSArIDMwKTtcclxuICBcclxuICBjb25zdCB0cnVzdGVkRGV2aWNlID0gYXdhaXQgcHJpc21hLnRydXN0ZWREZXZpY2UuY3JlYXRlKHtcclxuICAgIGRhdGE6IHtcclxuICAgICAgdXNlcklkLFxyXG4gICAgICBkZXZpY2VUb2tlbjogaGFzaGVkVG9rZW4sXHJcbiAgICAgIGRldmljZU5hbWUsXHJcbiAgICAgIHVzZXJBZ2VudDogZGV2aWNlSW5mby51c2VyQWdlbnQsXHJcbiAgICAgIGlwQWRkcmVzczogZGV2aWNlSW5mby5pcEFkZHJlc3MsXHJcbiAgICAgIGV4cGlyZXNBdCxcclxuICAgIH0sXHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIHtcclxuICAgIHRva2VuLFxyXG4gICAgZGV2aWNlSWQ6IHRydXN0ZWREZXZpY2UuaWQsXHJcbiAgfTtcclxufVxyXG5cclxuLy8gVmVyaWZ5IGlmIGEgZGV2aWNlIGlzIHRydXN0ZWQgYW5kIG5vdCBleHBpcmVkXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlUcnVzdGVkRGV2aWNlKFxyXG4gIHVzZXJJZDogc3RyaW5nLFxyXG4gIHRva2VuOiBzdHJpbmdcclxuKTogUHJvbWlzZTx7IGlzVmFsaWQ6IGJvb2xlYW47IGRldmljZUlkPzogc3RyaW5nIH0+IHtcclxuICBpZiAoIXRva2VuKSB7XHJcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSB9O1xyXG4gIH1cclxuICBcclxuICAvLyBHZXQgYWxsIHRydXN0ZWQgZGV2aWNlcyBmb3IgdGhlIHVzZXJcclxuICBjb25zdCB0cnVzdGVkRGV2aWNlcyA9IGF3YWl0IHByaXNtYS50cnVzdGVkRGV2aWNlLmZpbmRNYW55KHtcclxuICAgIHdoZXJlOiB7XHJcbiAgICAgIHVzZXJJZCxcclxuICAgICAgZXhwaXJlc0F0OiB7XHJcbiAgICAgICAgZ3Q6IG5ldyBEYXRlKCksIC8vIE5vdCBleHBpcmVkXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIFxyXG4gIC8vIENoZWNrIGVhY2ggZGV2aWNlIHRva2VuXHJcbiAgZm9yIChjb25zdCBkZXZpY2Ugb2YgdHJ1c3RlZERldmljZXMpIHtcclxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCB2ZXJpZnlEZXZpY2VUb2tlbih0b2tlbiwgZGV2aWNlLmRldmljZVRva2VuKTtcclxuICAgIGlmIChpc1ZhbGlkKSB7XHJcbiAgICAgIC8vIFVwZGF0ZSBsYXN0IHVzZWQgdGltZXN0YW1wIChzbGlkaW5nIGV4cGlyYXRpb24pXHJcbiAgICAgIGF3YWl0IHVwZGF0ZURldmljZUxhc3RVc2VkKGRldmljZS5pZCk7XHJcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIGRldmljZUlkOiBkZXZpY2UuaWQgfTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UgfTtcclxufVxyXG5cclxuLy8gVXBkYXRlIGRldmljZSBsYXN0IHVzZWQgdGltZXN0YW1wIGFuZCBleHRlbmQgZXhwaXJhdGlvbiAoc2xpZGluZyBleHBpcmF0aW9uKVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlRGV2aWNlTGFzdFVzZWQoZGV2aWNlSWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGNvbnN0IG5ld0V4cGlyZXNBdCA9IG5ldyBEYXRlKCk7XHJcbiAgbmV3RXhwaXJlc0F0LnNldERhdGUobmV3RXhwaXJlc0F0LmdldERhdGUoKSArIDMwKTtcclxuICBcclxuICBhd2FpdCBwcmlzbWEudHJ1c3RlZERldmljZS51cGRhdGUoe1xyXG4gICAgd2hlcmU6IHsgaWQ6IGRldmljZUlkIH0sXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgIGxhc3RVc2VkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIGV4cGlyZXNBdDogbmV3RXhwaXJlc0F0LCAvLyBTbGlkaW5nIGV4cGlyYXRpb25cclxuICAgIH0sXHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIEdldCBhbGwgdHJ1c3RlZCBkZXZpY2VzIGZvciBhIHVzZXJcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJUcnVzdGVkRGV2aWNlcyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8VHJ1c3RlZERldmljZURhdGFbXT4ge1xyXG4gIGNvbnN0IGRldmljZXMgPSBhd2FpdCBwcmlzbWEudHJ1c3RlZERldmljZS5maW5kTWFueSh7XHJcbiAgICB3aGVyZToge1xyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIGV4cGlyZXNBdDoge1xyXG4gICAgICAgIGd0OiBuZXcgRGF0ZSgpLCAvLyBPbmx5IG5vbi1leHBpcmVkIGRldmljZXNcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBvcmRlckJ5OiB7XHJcbiAgICAgIGxhc3RVc2VkQXQ6ICdkZXNjJyxcclxuICAgIH0sXHJcbiAgICBzZWxlY3Q6IHtcclxuICAgICAgaWQ6IHRydWUsXHJcbiAgICAgIGRldmljZU5hbWU6IHRydWUsXHJcbiAgICAgIHVzZXJBZ2VudDogdHJ1ZSxcclxuICAgICAgaXBBZGRyZXNzOiB0cnVlLFxyXG4gICAgICBjcmVhdGVkQXQ6IHRydWUsXHJcbiAgICAgIGxhc3RVc2VkQXQ6IHRydWUsXHJcbiAgICAgIGV4cGlyZXNBdDogdHJ1ZSxcclxuICAgIH0sXHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIGRldmljZXM7XHJcbn1cclxuXHJcbi8vIFJlbW92ZSBhIHNwZWNpZmljIHRydXN0ZWQgZGV2aWNlXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVUcnVzdGVkRGV2aWNlKHVzZXJJZDogc3RyaW5nLCBkZXZpY2VJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHByaXNtYS50cnVzdGVkRGV2aWNlLmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgaWQ6IGRldmljZUlkLFxyXG4gICAgICAgIHVzZXJJZCwgLy8gRW5zdXJlIHVzZXIgb3ducyB0aGUgZGV2aWNlXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyB0cnVzdGVkIGRldmljZTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBSZW1vdmUgYWxsIHRydXN0ZWQgZGV2aWNlcyBmb3IgYSB1c2VyXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZW1vdmVBbGxUcnVzdGVkRGV2aWNlcyh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJpc21hLnRydXN0ZWREZXZpY2UuZGVsZXRlTWFueSh7XHJcbiAgICB3aGVyZTogeyB1c2VySWQgfSxcclxuICB9KTtcclxuICBcclxuICByZXR1cm4gcmVzdWx0LmNvdW50O1xyXG59XHJcblxyXG4vLyBDbGVhbiB1cCBleHBpcmVkIHRydXN0ZWQgZGV2aWNlcyAoZm9yIGNyb24gam9iKVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xlYW51cEV4cGlyZWREZXZpY2VzKCk6IFByb21pc2U8bnVtYmVyPiB7XHJcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJpc21hLnRydXN0ZWREZXZpY2UuZGVsZXRlTWFueSh7XHJcbiAgICB3aGVyZToge1xyXG4gICAgICBleHBpcmVzQXQ6IHtcclxuICAgICAgICBsdDogbmV3IERhdGUoKSxcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIHJlc3VsdC5jb3VudDtcclxufVxyXG5cclxuLy8gR2V0IGFwcHJveGltYXRlIGxvY2F0aW9uIGZyb20gSVAgKHlvdSBtaWdodCB3YW50IHRvIGludGVncmF0ZSB3aXRoIGEgZ2VvIHNlcnZpY2UpXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBcHByb3hpbWF0ZUxvY2F0aW9uKGlwQWRkcmVzczogc3RyaW5nKTogc3RyaW5nIHtcclxuICAvLyBUaGlzIGlzIGEgcGxhY2Vob2xkZXIgLSBpbiBwcm9kdWN0aW9uIHlvdSdkIHVzZSBhIHNlcnZpY2UgbGlrZSBNYXhNaW5kIG9yIGlwYXBpXHJcbiAgaWYgKGlwQWRkcmVzcyA9PT0gJzEyNy4wLjAuMScgfHwgaXBBZGRyZXNzLnN0YXJ0c1dpdGgoJzE5Mi4xNjguJykgfHwgaXBBZGRyZXNzLnN0YXJ0c1dpdGgoJzEwLicpKSB7XHJcbiAgICByZXR1cm4gJ0xvY2FsIE5ldHdvcmsnO1xyXG4gIH1cclxuICByZXR1cm4gJ1Vua25vd24gTG9jYXRpb24nO1xyXG59XHJcblxyXG4vLyBNYXNrIElQIGFkZHJlc3MgZm9yIHByaXZhY3lcclxuZXhwb3J0IGZ1bmN0aW9uIG1hc2tJcEFkZHJlc3MoaXBBZGRyZXNzOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIGNvbnN0IHBhcnRzID0gaXBBZGRyZXNzLnNwbGl0KCcuJyk7XHJcbiAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gNCkge1xyXG4gICAgcmV0dXJuIGAke3BhcnRzWzBdfS4ke3BhcnRzWzFdfS4qLioqKmA7XHJcbiAgfVxyXG4gIHJldHVybiBpcEFkZHJlc3Muc2xpY2UoMCwgOCkgKyAnKioqJzsgLy8gRm9yIElQdjYgb3Igb3RoZXIgZm9ybWF0c1xyXG59ICJdLCJuYW1lcyI6WyJwcmlzbWEiLCJjcnlwdG8iLCJiY3J5cHQiLCJnZW5lcmF0ZURldmljZVRva2VuIiwicmFuZG9tQnl0ZXMiLCJ0b1N0cmluZyIsImhhc2hEZXZpY2VUb2tlbiIsInRva2VuIiwiaGFzaCIsInZlcmlmeURldmljZVRva2VuIiwiaGFzaGVkVG9rZW4iLCJjb21wYXJlIiwiZXh0cmFjdERldmljZU5hbWUiLCJ1c2VyQWdlbnQiLCJ1YSIsInRvTG93ZXJDYXNlIiwiYnJvd3NlciIsImluY2x1ZGVzIiwib3MiLCJjcmVhdGVUcnVzdGVkRGV2aWNlIiwidXNlcklkIiwiZGV2aWNlSW5mbyIsImRldmljZU5hbWUiLCJleHBpcmVzQXQiLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJ0cnVzdGVkRGV2aWNlIiwiY3JlYXRlIiwiZGF0YSIsImRldmljZVRva2VuIiwiaXBBZGRyZXNzIiwiZGV2aWNlSWQiLCJpZCIsInZlcmlmeVRydXN0ZWREZXZpY2UiLCJpc1ZhbGlkIiwidHJ1c3RlZERldmljZXMiLCJmaW5kTWFueSIsIndoZXJlIiwiZ3QiLCJkZXZpY2UiLCJ1cGRhdGVEZXZpY2VMYXN0VXNlZCIsIm5ld0V4cGlyZXNBdCIsInVwZGF0ZSIsImxhc3RVc2VkQXQiLCJnZXRVc2VyVHJ1c3RlZERldmljZXMiLCJkZXZpY2VzIiwib3JkZXJCeSIsInNlbGVjdCIsImNyZWF0ZWRBdCIsInJlbW92ZVRydXN0ZWREZXZpY2UiLCJkZWxldGUiLCJlcnJvciIsImNvbnNvbGUiLCJyZW1vdmVBbGxUcnVzdGVkRGV2aWNlcyIsInJlc3VsdCIsImRlbGV0ZU1hbnkiLCJjb3VudCIsImNsZWFudXBFeHBpcmVkRGV2aWNlcyIsImx0IiwiZ2V0QXBwcm94aW1hdGVMb2NhdGlvbiIsInN0YXJ0c1dpdGgiLCJtYXNrSXBBZGRyZXNzIiwicGFydHMiLCJzcGxpdCIsImxlbmd0aCIsInNsaWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/trusted-device-service.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/bcryptjs"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&page=%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fcheck-trusted-device%2Froute.ts&appDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Copeni%5COneDrive%5CBellRegistry%5Cpackages%5Cmain-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();